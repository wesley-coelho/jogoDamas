<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Damas</title>
        <style>
            *{
                margin: 0;
                padding:0;
                border: none;              
                text-decoration: none;
                list-style-type: none;
            }
            body{
                background-color: black;
            }
            #tabuleiro{
             
                width: 640px;
                height: 640px;
                margin: 10px auto;
                border: 5px solid white;
                display: flex;
                flex-direction: row;
                flex-wrap: wrap;
                align-items: center;                
            }

            .white-cell{
              width: 80px;
              height: 80px;              
              background-color: white;
              display: flex;
              flex-direction: row;
              flex-wrap: wrap;
              align-items: center;
              justify-content: center;
         
              
           
            }
            .black-cell{
              width: 80px;
              height: 80px;
              background-color: black;
              display: flex;
              flex-direction: row;
              flex-wrap: wrap;
              align-items: center;
              justify-content: center;
            
                     
            }
          
        </style>
    </head>
    <body>
        <div id="tabuleiro">
            <div class="white-cell"></div>
            <div id="cell-12" class="black-cell"><img id="peca-escura-1" class="peca-escura" src="peca-escura.png" width="70" ></div>
            <div class="white-cell"></div>
            <div id="cell-14" class="black-cell"><img id="peca-escura-2" class="peca-escura" src="peca-escura.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-16" class="black-cell"><img id="peca-escura-3" class="peca-escura" src="peca-escura.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-18" class="black-cell"><img id="peca-escura-4" class="peca-escura" src="peca-escura.png" width="70"></div>

            <div id="cell-21" class="black-cell"><img id="peca-escura-5" class="peca-escura" src="peca-escura.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-23" class="black-cell"><img id="peca-escura-6" class="peca-escura" src="peca-escura.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-25" class="black-cell"><img id="peca-escura-7" class="peca-escura" src="peca-escura.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-27" class="black-cell"><img id="peca-escura-8" class="peca-escura" src="peca-escura.png" width="70"></div>
            <div class="white-cell"></div>

            <div class="white-cell"></div>
            <div id="cell-32"  class="black-cell"><img id="peca-escura-9" class="peca-escura" src="peca-escura.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-34" class="black-cell"><img id="peca-escura-10" class="peca-escura" src="peca-escura.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-36" class="black-cell"><img id="peca-escura-11" class="peca-escura" src="peca-escura.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-38" class="black-cell"><img id="peca-escura-12" class="peca-escura" src="peca-escura.png" width="70"></div>

            <div id="cell-41" class="black-cell"></div>
            <div class="white-cell"></div>
            <div id="cell-43" class="black-cell"></div>
            <div class="white-cell"></div>
            <div id="cell-45" class="black-cell"></div>
            <div class="white-cell"></div>
            <div id="cell-47" class="black-cell"></div>
            <div class="white-cell"></div>

            <div class="white-cell"></div>
            <div id="cell-52" class="black-cell"></div>
            <div class="white-cell"></div>
            <div id="cell-54" class="black-cell"></div>
            <div class="white-cell"></div>
            <div id="cell-56" class="black-cell"></div>
            <div class="white-cell"></div>
            <div id="cell-58" class="black-cell"></div>

            <div id="cell-61" class="black-cell"><img id="peca-clara-1" class="peca-clara" src="peca-clara.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-63" class="black-cell"><img id="peca-clara-2" class="peca-clara" src="peca-clara.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-65" class="black-cell"><img id="peca-clara-3" class="peca-clara" src="peca-clara.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-67" class="black-cell"><img id="peca-clara-4" class="peca-clara" src="peca-clara.png" width="70"></div>            
            <div class="white-cell"></div>

            <div class="white-cell"></div>
            <div id="cell-72" class="black-cell"><img id="peca-clara-5" class="peca-clara" src="peca-clara.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-74" class="black-cell"><img id="peca-clara-6" class="peca-clara" src="peca-clara.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-76" class="black-cell"><img id="peca-clara-7" class="peca-clara" src="peca-clara.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-78" class="black-cell"><img id="peca-clara-8" class="peca-clara" src="peca-clara.png" width="70"></div>
            
            <div id="cell-81" class="black-cell"><img id="peca-clara-9" class="peca-clara" src="peca-clara.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-83" class="black-cell"><img id="peca-clara-10" class="peca-clara" src="peca-clara.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-85" class="black-cell"><img id="peca-clara-11" class="peca-clara" src="peca-clara.png" width="70"></div>
            <div class="white-cell"></div>
            <div id="cell-87" class="black-cell"><img id="peca-clara-12" class="peca-clara" src="peca-clara.png" width="70"></div>            
            <div class="white-cell"></div>

            
        </div>

        <script>

            var pecasEscuras = document.getElementsByClassName('peca-escura');
            var pecasClaras = document.getElementsByClassName('peca-clara');
           for(let i = 0; i < pecasEscuras.length; i++){
            pecasEscuras[i].draggable = true;
            pecasEscuras[i].ondragstart = drag;
            pecasEscuras[i].ondragend = paintDefaultColorCells;
           }

           for(let i = 0; i < pecasClaras.length; i++){
            pecasClaras[i].draggable = true;
            pecasClaras[i].ondragstart = drag;
            pecasClaras[i].ondragend = paintDefaultColorCells;
            
           }

            
           
           function allowDrop(ev){
            ev.preventDefault();
              

           }
           

           function drag(ev){
            ev.dataTransfer.setData("text", ev.target.id);
            const coluna = parseInt(ev.target.parentNode.id.substr(-1));
            const linha = parseInt(ev.target.parentNode.id.substr(5,1));
            let celulaAtualId = ("cell-" + linha + coluna);
            document.getElementById(celulaAtualId).removeEventListener('drop', drop);
            document.getElementById(celulaAtualId).removeEventListener('dragover',allowDrop);
            var idPecaAtualEscura = ev.target.id.substr(0,11);
                
                if ( idPecaAtualEscura == "peca-escura" ){
                        let linhaSul = linha + 1;
                        let linhaNorte = linha - 1;
                        let colunaOeste = coluna - 1;
                        let colunaLeste = coluna + 1;
                        
                        let celulaSudEsteId = ("cell-" + linhaSul + colunaLeste);
                        let celulaSudOEsteId = ("cell-" + linhaSul + colunaOeste);
                        let celulaNordEsteId = ("cell-" + linhaNorte + colunaLeste);
                        let celulaNorOesteId = ("cell-" + linhaNorte + colunaOeste);
                        if( coluna > 1 && coluna < 8 && linha > 1 && linha < 8){
                            if( !document.getElementById(celulaSudEsteId).hasChildNodes() ){
                            document.getElementById(celulaSudEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaSudEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaSudEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaSudEsteId).removeEventListener('dragover',allowDrop);
                        }               
                        
                        if( !document.getElementById(celulaSudOEsteId).hasChildNodes()  ){                    
                            document.getElementById(celulaSudOEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaSudOEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaSudOEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaSudOEsteId).removeEventListener('dragover',allowDrop);
                        }
                        document.getElementById(celulaNordEsteId).removeEventListener('drop', drop);
                        document.getElementById(celulaNordEsteId).removeEventListener('dragover',allowDrop);
                        document.getElementById(celulaNorOesteId).removeEventListener('drop', drop);
                        document.getElementById(celulaNorOesteId).removeEventListener('dragover',allowDrop);
                        console.log(celulaSudEsteId)
                        console.log(celulaSudOEsteId)
                        paintPossibleMovesCells(celulaSudEsteId);
                        paintPossibleMovesCells(celulaSudOEsteId);    
                    
                    }

                    if(  coluna == 1 && linha > 1 && linha < 8){
                        if( !document.getElementById(celulaSudEsteId).hasChildNodes() ){
                            document.getElementById(celulaSudEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaSudEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaSudEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaSudEsteId).removeEventListener('dragover',allowDrop);
                        }    
                        paintPossibleMovesCells(celulaSudEsteId)
                        document.getElementById(celulaNordEsteId).removeEventListener('drop', drop);
                        document.getElementById(celulaNordEsteId).removeEventListener('dragover',allowDrop);
                    }

                    if(  coluna > 1 && coluna < 8 && linha == 1 ){
                        if( !document.getElementById(celulaSudEsteId).hasChildNodes() ){
                            document.getElementById(celulaSudEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaSudEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaSudEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaSudEsteId).removeEventListener('dragover',allowDrop);
                        } 
                        
                        if( !document.getElementById(celulaSudOEsteId).hasChildNodes() ){
                            document.getElementById(celulaSudOEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaSudOEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaSudOEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaSudOEsteId).removeEventListener('dragover',allowDrop);
                        }   
                        paintPossibleMovesCells(celulaSudEsteId)
                        paintPossibleMovesCells(celulaSudOEsteId)
                        
                    }

                    if(  coluna == 8 && linha == 1 ){                   
                        
                        if( !document.getElementById(celulaSudOEsteId).hasChildNodes() ){
                            document.getElementById(celulaSudOEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaSudOEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaSudOEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaSudOEsteId).removeEventListener('dragover',allowDrop);
                        }   
                        
                        paintPossibleMovesCells(celulaSudOEsteId)                    
                    }
                    

                    if(  coluna == 8 && linha > 1 && linha < 8){
                        if( !document.getElementById(celulaSudOEsteId).hasChildNodes() ){
                            document.getElementById(celulaSudOEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaSudOEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaSudOEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaSudOEsteId).removeEventListener('dragover',allowDrop);
                        }    
                        paintPossibleMovesCells(celulaSudOEsteId)
                        document.getElementById(celulaNorOesteId).removeEventListener('drop', drop);
                        document.getElementById(celulaNorOesteId).removeEventListener('dragover',allowDrop);
                    }
                        
                        
                }
                var idPecaAtualClara = ev.target.id.substr(0,10);

                if ( idPecaAtualClara == "peca-clara" ){
                        let linhaSul = linha + 1;
                        let linhaNorte = linha - 1;
                        let colunaOeste = coluna - 1;
                        let colunaLeste = coluna + 1;
                        
                        let celulaSudEsteId = ("cell-" + linhaSul + colunaLeste);
                        let celulaSudOEsteId = ("cell-" + linhaSul + colunaOeste);
                        let celulaNordEsteId = ("cell-" + linhaNorte + colunaLeste);
                        let celulaNorOesteId = ("cell-" + linhaNorte + colunaOeste);
                        if( coluna > 1 && coluna < 8 && linha > 1 && linha < 8){
                            if( !document.getElementById(celulaNordEsteId).hasChildNodes() ){
                            document.getElementById(celulaNordEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaNordEsteId).addEventListener('dragover',allowDrop);
                            
                         
                    
                        }else{
                            document.getElementById(celulaNordEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaNordEsteId).removeEventListener('dragover',allowDrop);
                        }               
                        
                        if( !document.getElementById(celulaNorOesteId).hasChildNodes()  ){                    
                            document.getElementById(celulaNorOesteId).addEventListener('drop', drop);
                            document.getElementById(celulaNorOesteId).addEventListener('dragover',allowDrop);
                             
                        }else{
                            document.getElementById(celulaNorOesteId).removeEventListener('drop', drop);
                            document.getElementById(celulaNorOesteId).removeEventListener('dragover',allowDrop);
                        }
                        document.getElementById(celulaSudEsteId).removeEventListener('drop', drop);
                        document.getElementById(celulaSudEsteId).removeEventListener('dragover',allowDrop);
                        document.getElementById(celulaSudOEsteId).removeEventListener('drop', drop);
                        document.getElementById(celulaSudOEsteId).removeEventListener('dragover',allowDrop);
                        console.log(celulaNordEsteId)
                        console.log(celulaNorOesteId)
                        paintPossibleMovesCells(celulaNordEsteId);
                        paintPossibleMovesCells(celulaNorOesteId);  
                        
                    }

                    if(  coluna == 8 && linha > 1 && linha < 8){
                        if( !document.getElementById(celulaNorOesteId).hasChildNodes() ){
                            document.getElementById(celulaNorOesteId).addEventListener('drop', drop);
                            document.getElementById(celulaNorOesteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaNorOesteId).removeEventListener('drop', drop);
                            document.getElementById(celulaNorOesteId).removeEventListener('dragover',allowDrop);
                        }    
                        paintPossibleMovesCells(celulaNorOesteId)
                        document.getElementById(celulaSudOEsteId).removeEventListener('drop', drop);
                        document.getElementById(celulaSudOEsteId).removeEventListener('dragover',allowDrop);
                    }

                    if(  coluna > 1 && coluna < 8 && linha == 8 ){
                        if( !document.getElementById(celulaNordEsteId).hasChildNodes() ){
                            document.getElementById(celulaNordEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaNordEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaNordEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaNordEsteId).removeEventListener('dragover',allowDrop);
                        } 
                        
                        if( !document.getElementById(celulaNorOesteId).hasChildNodes() ){
                            document.getElementById(celulaNorOesteId).addEventListener('drop', drop);
                            document.getElementById(celulaNorOesteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaNorOesteId).removeEventListener('drop', drop);
                            document.getElementById(celulaNorOesteId).removeEventListener('dragover',allowDrop);
                        }   
                        paintPossibleMovesCells(celulaNordEsteId)
                        paintPossibleMovesCells(celulaNorOesteId)
                        
                    }

                    if(  coluna == 1 && linha == 8 ){                   
                        
                        if( !document.getElementById(celulaNordEsteId).hasChildNodes() ){
                            document.getElementById(celulaNordEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaNordEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaNordEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaNordEsteId).removeEventListener('dragover',allowDrop);
                        }   
                        
                        paintPossibleMovesCells(celulaNordEsteId)                    
                    }
                    

                    if(  coluna == 1 && linha > 1 && linha < 8){
                        if( !document.getElementById(celulaNordEsteId).hasChildNodes() ){
                            document.getElementById(celulaNordEsteId).addEventListener('drop', drop);
                            document.getElementById(celulaNordEsteId).addEventListener('dragover',allowDrop);
                        }else{
                            document.getElementById(celulaNordEsteId).removeEventListener('drop', drop);
                            document.getElementById(celulaNordEsteId).removeEventListener('dragover',allowDrop);
                        }    
                        paintPossibleMovesCells(celulaNordEsteId)
                        document.getElementById(celulaSudEsteId).removeEventListener('drop', drop);
                        document.getElementById(celulaSudEsteId).removeEventListener('dragover',allowDrop);
                    }
                        
                        
                }

                

            }

            
               
                
            
            
            // ev.target.parentNode.id) retorna o id do pai
        

           function drop(ev){
            ev.preventDefault();
            var data = ev.dataTransfer.getData("text");
            ev.target.appendChild(document.getElementById(data));
            var blackCells = document.getElementsByClassName('black-cell');
            for(let i = 0; i < blackCells.length; i++){
                blackCells[i].style.backgroundColor = "black";
                blackCells[i].removeEventListener('drop', drop);
                blackCells[i].removeEventListener('dragover',allowDrop);
           }
                      
            
           }

           function paintPossibleMovesCells(id){
               document.getElementById(id).style.backgroundColor = "red";
           }
           function paintDefaultColorCells(ev){
            var blackCells = document.getElementsByClassName('black-cell');
            for(let i = 0; i < blackCells.length; i++){
                blackCells[i].style.backgroundColor = "black";
          
           }
           }

         
           

        </script>
       
    </body>

</html>